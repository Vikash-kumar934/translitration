import psycopg2
import sys
import glob
import re
import json
import itertools
import pandas as pd

# from translation.models import EnglishToHindiTranslation
from translation.models import EnglishToGujaratiTranslation
from django.contrib.admin.utils import flatten
from operator import getitem
import time


class Translate_Gujarati:
    dict_tr_g = {'ક': 'k;c;q',
                 'ખ ': 'kh',
                 'ગ ': 'g',
                 'ઘ ': 'gh',
                 'ડ્ ': 'dh;rh',
                 'ચ ': 'ch',
                 'છ ': 'chh',
                 'જ ': 'j',
                 'ઝ ': 'jh',
                 'ય ': 'y',
                 'ટ ': 't',
                 'ઠ ': 'th',
                 'ડ ': 'd',
                 'ઢ ': 'rh;dh',
                 'ણ ': 'n',
                 'ત ': 't',
                 'થ ': 'th',
                 'દ ': 'd',
                 'ધ ': 'dh',
                 'ન ': 'n',
                 'પ ': 'p',
                 'ફ ': 'ph;f',
                 'બ ': 'b',
                 'ભ ': 'bh',
                 'મ ': 'm',
                 'ર ': 'r',
                 'લ ': 'l',
                 'વ ': 'v;w',
                 'શ ': 'sh',
                 'ષ ': 'sh',
                 'સ ': 's',
                 'હ ': 'h'}

    dict_en = {'k': ['ક', 'ક્'],
               'c': ['ક'],
               'q': ['ક', 'ક્'],
               'kh': ['ખ', 'ખ્'],
               'g': ['ગ'],
               'gh': ['ઘ'],
               'd': ['ડ્', 'ડ', 'દ', 'ડ્'],
               'ch': ['ચ', 'છ'],
               'chh': ['છ'],
               'j': ['જ'],
               'jh': ['ઝ'],
               'ny': ['ય', 'ન્ય'],
               't': ['ટ', 'ત'],
               'th': ['ઠ', 'થ'],
               'dh': ['ઢ', 'ધ', 'ડ્', 'ઢ'],
               'n': ['ણ', 'ન', 'ઁ', 'ં'],
               'p': ['પ'],
               'ph': ['ફ', 'ફ્'],
               'f': ['ફ', 'ફ્'],
               'b': ['બ'],
               'bh': ['ભ'],
               'm': ['મ', 'ં'],
               'y': ['ય'],
               'r': ['ર'],
               'l': ['લ'],
               'v': ['વ'],
               'w': ['વ'],
               'rh': ['ડ્', 'ઢ'],
               'sh': ['શ', 'ષ'],
               's': ['સ'],
               'h': ['હ'],
               'tch': ['ચ'],
               'tion': ['શન'],
               'z': ['જ્', 'જ'],
               'ye': ['એ', 'યે'],
               'yi': ['યી', 'ઈ'],
               'x': ['ક્સ']
               }

    dict_en1 = {'k': ['ક', 'ક્'],
                'c': ['ક'],
                'q': ['ક', 'ક્'],
                'g': ['ગ'],
                'd': ['ડ્', 'ડ', 'દ', 'ડ્'],
                'j': ['જ'],
                't': ['ટ', 'ત'],
                'n': ['ણ', 'ન', 'ઁ', 'ં'],
                'p': ['પ'],
                'f': ['ફ', 'ફ્'],
                'b': ['બ'],
                'm': ['મ', 'ં'],
                'y': ['ય'],
                'r': ['ર'],
                'l': ['લ'],
                'v': ['વ'],
                'w': ['વ'],
                's': ['સ'],
                'h': ['હ'],
                'z': ['જ્', 'જ'],
                'x': ['ક્સ']
                }

    dict_en2 = {'kh': ['ખ', 'ખ્'],
                'gh': ['ઘ'],
                'ch': ['ચ', 'છ'],
                'jh': ['ઝ'],
                'ny': ['ય', 'ન્ય'],
                'th': ['ઠ', 'થ'],
                'dh': ['ઢ', 'ધ', 'ડ્', 'ઢ'],
                'ph': ['ફ', 'ફ્'],
                'bh': ['ભ'],
                'rh': ['ડ્', 'ઢ'],
                'sh': ['શ', 'ષ'],
                'ye': ['એ', 'યે'],
                'yi': ['યી', 'ઈ']
                }

    dict_en3 = {'chh': ['છ'], 'tch': ['ચ'], 'tion': ['શન']
                }

    half = {'k': {'ક્': 100, 'ક઼્': 20, 'ક': 0, 'ક઼': 0},
            'c': {'ક્': 100, 'ક': 0},
            'q': {'ક્': 10, 'ક઼્': 100, 'ક': 0, 'ક઼': 0},
            'g': {'ગ્': 100, 'ગ': 0},
            'd': {'ડ્': 0, 'દ્': 100, 'ડ': 0, 'દ': 0, 'ડ઼': 0},
            'j': {'જ્': 100, 'જ': 0},
            't': {'ટ્': 100, 'ત્': 80, 'ટ': 0, 'ત': 0},
            'n': {'ણ્': 60, 'ન્': 80, 'ઁ': 40, 'ં': 100, 'ણ': 0, 'ન': 0},
            'p': {'પ્': 100, 'પ': 0},
            'f': {'ફ્': 100, 'ફ઼્': 60, 'ફ': 0, 'ફ઼': 0},
            'b': {'બ્': 100, 'બ': 0},
            'm': {'મ્': 100, 'ં': 100, 'મ': 0},
            'y': {'ય્': 100, 'ય': 0},
            'r': {'ર્': 100, 'ર': 0},
            'l': {'લ્': 100, 'લ': 0},
            'v': {'વ્': 100, 'વ': 0},
            'w': {'વ્': 100, 'વ': 0},
            's': {'સ્': 100, 'સ': 0},
            'h': {'હ્': 100, 'હ': 0},
            'z': {'જ઼્': 100, 'જ્': 60, 'જ઼': 0, 'જ': 0},
            'x': {'ક્સ્': 100, 'ક્સ': 0},
            'kh': {'ખ્': 100, 'ખ઼્': 80, 'ખ': 0, 'ખ઼': 0},
            'gh': {'ઘ્': 100, 'ઘ': 0},
            'ch': {'ક્': 40, 'ચ્': 100, 'ચ': 0, 'છ': 0},
            'th': {'ઠ્': 100, 'થ્': 80, 'ઠ': 0, 'થ': 0},
            'dh': {'ઢ્': 100, 'ધ્': 100, 'ઢ': 0, 'ધ': 0, 'ડ઼': 0, 'ઢ઼': 0},
            'ph': {'ફ્': 100, 'ફ઼્': 60, 'ફ': 0, 'ફ઼': 0},
            'bh': {'ભ્': 100, 'ભ': 0},
            'rh': {'ઢ઼': 100, 'ડ઼': 40},
            'sh': {'શ્': 100, 'ષ્': 100, 'શ': 0, 'ષ': 0},
            'yi': {'ઈ': 100, 'યી': 0},
            'tch': {'ચ્': 100, 'ચ': 0},
            'tion': {'શન્': 100, 'શન': 0},
            'chh': {'છ્': 100, 'છ': 0},
            'jh': {'ઝ્': 100, 'ઝ': 0},
            'ny': {'ન્ય': 100, 'ય': 10},
            'ye': {'યે': 100, 'એ': 20}
            }

    dictf = {1: {'b': {'બ': 100},
                 'c': {'ક': 100, 'સ': 10},
                 'd': {'દ': 100, 'ડ': 25, 'ડ઼': 0},
                 'f': {'ફ઼': 3, 'ફ': 100},
                 'g': {'ગ': 100},
                 'h': {'હ': 100},
                 'j': {'જ': 100},
                 'k': {'ક': 100, 'ક઼': 0},
                 'l': {'લ': 100},
                 'm': {'મ': 100},
                 'n': {'ન': 100, 'ણ': 0},
                 'p': {'પ': 100},
                 'q': {'ક઼': 100, 'ક': 100},
                 'r': {'ર': 100},
                 's': {'સ': 100},
                 't': {'ટ': 26, 'ત': 100},
                 'v': {'વ': 100},
                 'w': {'વ': 100},
                 'x': {'ક્સ': 100},
                 'y': {'ય': 100},
                 'z': {'જ઼': 100, 'જ': 66},
                 'bh': {'ભ': 100},
                 'ch': {'ચ': 100, 'છ': 2},
                 'dh': {'ધ': 100, 'ઢ': 15, 'ઢ઼': 1, 'ડ઼': 0},
                 'gh': {'ઘ': 100},
                 'jh': {'ઝ': 100},
                 'kh': {'ખ': 100, 'ખ઼': 0},
                 'ny': {'ન્ય': 100},
                 'rh': {'ઢ઼': 100, 'ડ઼': 40},
                 'ph': {'ફ': 100, 'ફ઼': 2},
                 'sh': {'શ': 100, 'ષ': 1},
                 'th': {'થ': 72, 'ઠ': 100},
                 'ye': {'એ': 6, 'યે': 100},
                 'yi': {'યી': 100},
                 'tion': {'શન': 100},
                 'tch': {'ચ્': 100, 'ચ': 0},
                 'chh': {'છ': 100}
                 },
             0: {'a': {'અ': 100, 'આ': 25},
                 'e': {'એ': 100, 'ઇ': 0, 'ઈ': 0},
                 'i': {'ઇ': 100, 'ઈ': 14},
                 'o': {'ઓ': 66},
                 'u': {'ઉ': 100, 'ઊ': 1},
                 'aa': {'આ': 100},
                 'ae': {'એ': 40, 'આએ': 42, 'અએ': 20},
                 'ai': {'એ': 100, 'આઈ': 12},
                 'ao': {'ઔ': 19, 'ઓ': 100, 'અવ': 19},
                 'au': {'ઔ': 100, 'અઊ': 0, 'આઊ': 0, 'આઉ': 0},
                 'ea': {'એ': 97, 'ઈ': 100, 'એઅ': 31, 'ઇ': 40},
                 'ee': {'ઈ': 100, 'ઇ': 46, 'એ': 38},
                 'ei': {'એ': 12, 'ઈ': 100, 'એઈ': 41, 'એઇ': 39, 'ઇ': 14},
                 'eo': {'એઓ': 100, 'ઇઓ': 50, 'એવ': 50, 'ઈઓ': 50},
                 'eu': {'એયુ': 28, 'એઉ': 100, 'યુ': 18},
                 'ia': {'ઇઅ': 32, 'ઇ': 25, 'ઇઆ': 23, 'ઇયા': 100},
                 'ie': {'ઈ': 50, 'ઇએ': 100, 'આઈ ઈ': 38},
                 'ii': {'ઈ': 100, 'ઈઇ': 1},
                 'io': {'ઇઓ': 100, 'આય': 11},
                 'iu': {'ઇઉ': 25, 'ઇુ': 100, 'ઈઉ': 9, 'ઇયુ': 22, 'ઈયુ': 16, 'ઇયૂ': 9},
                 'oa': {'ઓ': 20, 'ઓઆ': 60, 'ઓએ': 60, 'ઓવા': 20, 'ઓઅ': 20},
                 'oe': {'ઓએ': 100},
                 'oi': {'ઓઈ': 61, 'ઓઇ': 100},
                 'oo': {'ઊ': 100},
                 'ou': {'ઓઉ': 100, 'ઔ': 69, 'ઓ': 23},
                 'ua': {'ઉ': 100, 'ઉઅ': 69, 'ઉॅ': 30, 'ઉઆ': 13, 'ઊ': 20},
                 'ue': {'ઉે': 100, 'ઉએ': 19},
                 'ui': {'ઉઇ': 100, 'ઉી': 47, 'ઉિ': 52, 'ઉઈ': 42, 'યુઈ': 10},
                 'uo': {'ઉવ': 100, 'ઊઆ': 5, 'ઉઓ': 5},
                 'uu': {'ઊ': 100, 'ઉયુ': 0},
                 'aaa': {'આઅ': 40, 'આઆ': 20, 'અઆ': 40, 'આ': 100},
                 'aae': {'આએ': 100, 'આઇ': 15, 'આય': 15},
                 'aai': {'આઇ': 60, 'એ': 20, 'આઈ': 100, 'અએ': 10, 'આએ': 10},
                 'aao': {'આઊ': 6, 'આઓ': 100, 'આવ': 18},
                 'aau': {'આઉ': 66, 'આઊ': 66, 'ઔ': 100, 'આયુ': 33, 'અઅુ': 33},
                 'aea': {'એઅ': 100, 'ઓ': 100},
                 'aee': {'આઈ': 100, 'અઈ': 50, 'એઇએ': 8, 'આએ': 8},
                 'aei': {'એઇ': 100, 'અઇ': 33, 'એૈ': 33},
                 'aia': {'આયા': 100, 'આઇઅ': 100, 'આઇઆ': 100},
                 'aie': {'એે': 100},
                 'aii': {'અઈ': 100, 'આઈ': 33, 'એઇ': 25, 'એઈ': 8},
                 'aio': {'આયો': 100, 'અયો': 100, 'એઓ': 100, 'આઇઓ': 100},
                 'aiu': {'આઈઉ': 100,
                         'અૈયૂ': 50,
                         'આઇયુ': 100,
                         'આઇઉ': 100,
                         'એયૂ': 50,
                         'અૈયુ': 100,
                         'આઈયુ': 50,
                         'એઉ': 100,
                         'એયુ': 50},
                 'aoo': {'આઊ': 100},
                 'aou': {'આઓ': 24, 'ઓ': 50, 'ઔ': 100, 'અ': 12, 'ઓઉ': 12},
                 'aua': {'ઔઅ': 50,
                         'આયુॅ': 50,
                         'આૈ': 50,
                         'ઔॅ': 100,
                         'ઔા': 100,
                         'ઔ': 100,
                         'આૈા': 50},
                 'aue': {'ઔએ': 100, 'ઔય': 20},
                 'aui': {'ઔઈ': 85, 'ઔઇ': 100},
                 'auo': {'ઔઓ': 100, 'અવો': 100},
                 'auu': {'અયૂૂ': 31, 'ઔયુ': 100, 'ઔઉ': 65, 'આયુુ': 31, 'અુુ': 31},
                 'eaa': {'એઆ': 100},
                 'eae': {'ઈ': 100, 'ઇએ': 12},
                 'eai': {'એ': 70, 'એઆઈ': 30, 'ઈ': 100},
                 'eau': {'એયુ': 100},
                 'eee': {'એઈ': 50, 'ઈ': 100, 'ઈએ': 50},
                 'eia': {'એઇઅ': 11, 'એયા': 100},
                 'eii': {'એઈઇ': 11, 'એઈ': 100},
                 'eio': {'ઇયો': 100},
                 'eiu': {'એઇઉ': 100},
                 'eoo': {'એઊ': 100},
                 'eua': {'ઇઉ': 100},
                 'tion': {'શન': 100},
                 'eue': {'યૂએ': 100},
                 'iai': {'ઇએ': 100, 'ઈઆઇ': 20},
                 'iau': {'ઇઔ': 100},
                 'iea': {'આઇ': 100, 'ઇ': 100},
                 'iua': {'યુએ': 100},
                 'iui': {'ઇઉઈ': 100},
                 'iuu': {'ઈયુ': 100, 'ઈઊ': 100},
                 'oaa': {'ઓ.એ.અ': 25, 'ઓવા': 100},
                 'oai': {'ઓૈ': 40, 'ઓએ': 100, 'ઓઈ': 60},
                 'oao': {'ઓઆઓ': 100},
                 'oau': {'ઓઔ': 100, 'આઓ': 100},
                 'oie': {'ઓઇએ': 100, 'ઓઇે': 100},
                 'ooa': {'ઊ': 100},
                 'ooi': {'ઊઈ': 100, 'ઉઈ': 50, 'ઓઈ': 50, 'ઓઇ': 50},
                 'ooo': {'ઓઊ': 100},
                 'oua': {'ઔ': 100},
                 'uaa': {'ઉઆ': 100},
                 'uai': {'ઊએ': 100, 'યુએ': 66},
                 'uau': {'વઊ': 100},
                 'uea': {'ઉએઅ': 100, 'યૂઈ': 100, 'યુઈ': 100},
                 'uia': {'ઉયા': 100},
                 'uii': {'ઉઈ': 100},
                 'uua': {'ઊઆ': 100},
                 'uuu': {'ઉઊ': 42, 'ઉઉઉ': 100},
                 'aaaa': {'આઆ': 100},
                 'aaao': {'આઓ': 100},
                 'aaie': {'આએે': 100},
                 'aaii': {'આઇ': 100},
                 'aaiu': {'અૈયૂ': 100},
                 'aaoo': {'આઊ': 100, 'આઓ': 33},
                 'aiai': {'એએ': 100, 'એ': 100},
                 'aieo': {'આઇઓ': 100},
                 'aieu': {'એેયુ': 100},
                 'auaa': {'આૈાા': 100},
                 'auai': {'અયુૈ': 100, 'અૂઅી': 100},
                 'eaiu': {'એૈયુ': 100},
                 'eeai': {'ેએૈ': 100},
                 'iuai': {'ઇઉાઈ': 100},
                 'iuiu': {'ઇઉઇઉ': 100},
                 'oooo': {'ોોૂ': 100},
                 'aaaaa': {'અઅઅઅઅ': 100, 'આઆઅ': 100},
                 'aieai': {'એેૈ': 100},
                 'eeaiu': {'ેએૈયુ': 100},
                 'eeeee': {'ઇ': 100},
                 'oooooo': {'ઊઊઊ': 100},
                 'aaaaaaaaa': {'આઆઆઆઆ': 100},
                 'aeo': {'એઓ': 100, 'આઇઓ': 0},
                 'aeu': {'આયુ': 50, 'એઉ': 100, 'એઊ': 100},
                 'aoa': {'આવા': 25, 'આવૈ': 0, 'અવા': 100},
                 'aoe': {'ઔએ': 100, 'ઔય': 20},
                 'aoi': {'ઔએ': 42, 'ઓ': 100},
                 'eao': {'ઈઓ': 42, 'એઓ': 100},
                 'eea': {'ઇઆ': 100, 'ઈ': 100},
                 'eei': {'ઈ': 100, 'અઈ': 100},
                 'eeo': {'ઈઓ': 100},
                 'eeu': {'ઈઊ': 100, 'ઇઉ': 0},
                 'eie': {'ઇએ': 25, 'ઈ': 100},
                 'eoa': {'એવા': 100, 'એઓ': 25, 'એઓએ': 0},
                 'eoe': {'ઇવે': 25, 'એવે': 0, 'એઓએ': 0},
                 'eoi': {'એવી': 25, 'ઇવી': 0, 'ઇઓઆઈ': 0},
                 'eou': {'એવુ': 100, 'ઇઓ': 0},
                 'eui': {'યુઈ': 100, 'યૂઈ': 33, 'યૂઇ': 33, 'ઈ': 0},
                 'euo': {'યૂઓ': 100, 'ઓ': 25},
                 'euu': {'ઈઊ': 40, 'એઊ': 100, 'ઊ': 60},
                 'iaa': {'ઇઆ': 100},
                 'iae': {'ઇએ': 100, 'ઈએ': 25},
                 'iao': {'ઈઓ': 66, 'યાઓ': 100},
                 'iee': {'ઈ': 100, 'ઇએ': 25},
                 'iei': {'આઈ': 66, 'ઈ': 100},
                 'ieo': {'ઇયો': 25, 'ઈયો': 100},
                 'ieu': {'ઈયૂ': 100, 'યેઊ': 25},
                 'iia': {'આઈઆઈએ': 0, 'ઇયા': 25, 'ઈયા': 100},
                 'iie': {'ઈએ': 100, 'ઈયે': 25},
                 'iii': {'ઈ': 100, 'આઈ': 0},
                 'iio': {'ઈઓ': 25, 'ઈયો': 100},
                 'iiu': {'ઈઊ': 100, 'ઇઉ': 0},
                 'ioa': {'ઇવા': 100},
                 'ioe': {'ઇવે': 100, 'એઓએ': 25},
                 'ioi': {'ઇવી': 100, 'યોઈ': 25},
                 'ioo': {'ઈઊ': 100, 'ઇઉ': 0},
                 'iou': {'ઇવૂ': 100},
                 'iue': {'ઈવે': 100, 'ઇવે': 25, 'ઇયે': 0},
                 'iuo': {'યૂઓ': 66, 'ઈઓ': 0, 'ઈવો': 100},
                 'oae': {'ઓએ': 100},
                 'oea': {'ઓઈ': 100, 'ઓઇ': 42},
                 'oee': {'ઓઈ': 100, 'ઓઇ': 11},
                 'oei': {'ઓઈ': 100, 'ઓઇ': 11},
                 'oeo': {'ઓયો': 100, 'ઓએઓ': 0},
                 'oeu': {'ઓયુ': 100, 'વેઊ': 25, 'ઓએઓ': 0},
                 'oia': {'ઓયા': 100, 'વીયા': 25},
                 'oii': {'ઓઈ': 100},
                 'oio': {'ઓયો': 100, 'ઓએઓ': 0},
                 'oiu': {'ઓયુ': 100, 'ઓયૂ': 25},
                 'ooe': {'ઊએ': 100, 'ઊઈ': 25},
                 'oou': {'ઓઊ': 100, 'ઓઉ': 11},
                 'oue': {'ઓએ': 100},
                 'oui': {'ઓઇ': 100, 'ઊઈ': 25, 'વુઈ': 0},
                 'ouo': {'ઓઊઓ': 0, 'ઓ': 100},
                 'ouu': {'ઓઊ': 100},
                 'uae': {'ઊએ': 100, 'ઊઈ': 40, 'ઉએ': 60},
                 'uao': {'વઓ': 0, 'ઊઆ': 25, 'ઉઓ': 100},
                 'uee': {'ઉઈ': 100, 'ઊએ': 0},
                 'uei': {'ઉઈ': 100, 'ઊએ': 0},
                 'ueo': {'ઉયો': 100, 'ઊ': 0},
                 'ueu': {'ઉએઊ': 0, 'યૂ': 42, 'ઊ': 100},
                 'uie': {'ઉઈ': 100, 'ઉયે': 25},
                 'uio': {'ઉયો': 100},
                 'uiu': {'ઊઇઉ': 100},
                 'uoa': {'ઉવા': 100},
                 'uoe': {'ઉવે': 25, 'ઊવે': 100},
                 'uoi': {'ઉવી': 25, 'ઓઈ': 100},
                 'uoo': {'ઉઊ': 25, 'ઉવો': 100},
                 'uou': {'ઉઓ': 100},
                 'uue': {'ઊએ': 100},
                 'uui': {'ઊઈ': 100, 'ઉઈ': 50, 'ઓઈ': 50, 'ઓઇ': 50},
                 'uuo': {'ઊઓ': 100}
                 }}

    dictm = {1: {'b': {'બ': 100},
                 'c': {'ક': 100, 'સ': 10},
                 'd': {'દ': 100, 'ડ': 15, 'ડ઼': 4, 'ડ્': 0},
                 'f': {'ફ': 100, 'ફ઼': 4},
                 'g': {'ગ': 100},
                 'h': {'હ': 100},
                 'j': {'જ': 100},
                 'k': {'ક': 100, 'ક઼': 0},
                 'l': {'લ': 100},
                 'm': {'મ': 100},
                 'n': {'ન': 100, 'ણ': 42},
                 'p': {'પ': 100},
                 'q': {'ક઼': 75, 'ક': 100},
                 'r': {'ર': 100},
                 's': {'સ': 100},
                 't': {'ત': 100, 'ટ': 100},
                 'v': {'વ': 100},
                 'w': {'વ': 100},
                 'x': {'ક્સ': 100},
                 'y': {'ય': 100},
                 'z': {'જ઼': 100, 'જ': 96},
                 'bh': {'ભ': 100},
                 'ch': {'ચ': 100, 'છ': 0},
                 'dh': {'ધ': 100, 'ઢ઼': 6, 'ઢ': 10, 'ડ઼': 50},
                 'gh': {'ઘ': 100},
                 'jh': {'ઝ': 100},
                 'kh': {'ખ': 100, 'ખ઼': 0},
                 'ny': {'ન્ય': 100, 'ણ્ય': 5, 'ંય': 11},
                 'ph': {'ફ': 100, 'ફ઼': 4},
                 'rh': {'ઢ઼': 85, 'ડ઼': 100},
                 'sh': {'શ': 100, 'ષ': 20},
                 'th': {'ઠ': 56, 'થ': 100},
                 'ye': {'એ': 9, 'યે': 100},
                 'yi': {'ઈ': 7, 'યી': 100},
                 'chh': {'છ': 100},
                 'tion': {'શન': 100},
                 'tch': {'ચ': 100}
                 },
             0: {'a': {'': 100, 'ા': 100, 'ૈ': 0},
                 'e': {'ે': 100, '': 25},
                 'i': {'િ': 100, 'ી': 100},
                 'o': {'ો': 100},
                 'u': {'ુ': 100, 'ૂ': 12},
                 'aa': {'ા': 100},
                 'ae': {'ાએ': 100, 'ૈ': 11, 'એ': 77},
                 'ai': {'ૈ': 100, 'ાઈ': 16},
                 'ao': {'ાઓ': 100, 'ો': 23, 'ૌ': 10, 'ઓ': 48, 'ાવ': 74},
                 'au': {'ૌ': 100, 'ાઉ': 25},
                 'ea': {'ે': 54, 'ી': 27, 'ેઆ': 100},
                 'ee': {'ી': 100, 'િ': 9},
                 'ei': {'ે': 51, 'ેઈ': 72, 'ેઇ': 100},
                 'eo': {'ેઓ': 100, 'ેવ': 77, 'િયો': 44},
                 'eu': {'ેઉ': 100, 'ેયુ': 28},
                 'ia': {'ીયા': 60, 'િઆ': 46, 'ીઅ': 86, 'ીઆ': 40, 'િયા': 100},
                 'ie': {'િએ': 100, 'ીએ': 69, 'ાઈ': 62},
                 'ii': {'ી': 100, 'િ': 25},
                 'io': {'િઓ': 100, 'િયો': 33, 'ીઓ': 33},
                 'iu': {'િઉ': 65, 'ીઉ': 65, 'િયુ': 100, 'ીયુ': 12},
                 'oa': {'ો': 33, 'ોઆ': 100},
                 'oe': {'ોએ': 100, 'ો': 41, 'ોઇ': 25},
                 'oi': {'ોઇ': 100, 'ોઈ': 56},
                 'oo': {'ૂ': 100},
                 'ou': {'ૌ': 100, 'ોઉ': 26},
                 'ua': {'ુઆ': 100, 'ુ': 5, 'ૂ': 5},
                 'ue': {'ુએ': 100},
                 'ui': {'ુઇ': 25, 'ુઈ': 100, 'ૂઇ': 25, 'ૂઈ': 100},
                 'uo': {'ુઓ': 100, 'ુઆ': 5},
                 'uu': {'ુઉ': 0, 'ૂઉ': 0, 'ુયુ': 5, 'ૂ': 100},
                 'aaa': {'ા': 21, 'આ': 100, 'ાઆ': 21},
                 'aae': {'ાએ': 100, 'ાઈ': 5, 'ાઇ': 5},
                 'aai': {'ાઇ': 16, 'ાઈ': 100, 'ાએ': 50},
                 'aao': {'ાઓ': 100, 'ાઊ': 5},
                 'aau': {'ાઊ': 100, 'ાઉ': 33, 'ઔ': 66, 'ાઅુ': 0, 'ાઔ': 66, 'આવ': 66},
                 'aea': {'ઈ': 75, 'ાઈ': 75, 'ઇ': 0, 'એય': 100},
                 'aee': {'ઈ': 100, 'ાઈ': 42, 'ઇ': 0, 'ી': 0},
                 'aei': {'ે': 33,
                         'ઈ': 100,
                         'ાઈ': 100,
                         'એ': 16,
                         'ેઇ': 66,
                         'ાઇ': 0,
                         'ઇ': 16,
                         'ૈઇ': 0},
                 'aeo': {'ેઓ': 100},
                 'aeu': {'ાએઉ': 42, 'ેયુ': 100, 'ઈઉ': 42},
                 'aia': {'ય': 0, 'યા': 100, 'ઇઆ': 14, 'ૈ': 0, 'ય્યા': 28},
                 'aie': {'ાઇ': 10, 'ૈએ': 100, 'ાઈએ': 24},
                 'aii': {'ાઈ': 80, 'ૈઇ': 20, 'ઈ': 100},
                 'aio': {'ૈઓ': 100, 'ાઈઓ': 100, 'ાયો': 100},
                 'aiu': {'ૈયુ': 100, 'ૈયૂ': 75, 'ાઈઉ': 7, 'ાઇઉ': 5, 'ઈઉ': 12, 'ૈઉ': 62},
                 'aoi': {'ઓઇ': 100, 'ાઈ': 100, 'ોઈ': 100},
                 'aoo': {'ાઊ': 100, 'ઊ': 66},
                 'aou': {'ાવુ': 25,
                         'ઓઉ': 5,
                         'ાઓઉ': 0,
                         'ૌ': 100,
                         'ાઓ': 5,
                         'ોઊ': 5,
                         'ોઉ': 5,
                         'ાઉ': 5},
                 'aua': {'ૌઆ': 100, 'ૌ': 58, 'ાઉ': 8},
                 'aue': {'ૌએ': 100, 'ાઉે': 11},
                 'aui': {'ૌઈ': 100, 'ૌઇ': 25},
                 'auo': {'ૌઓ': 100, 'ઉઓ': 8, 'ૌઊ': 8, 'ઊઓ': 33},
                 'auu': {'ાઉુ': 0, 'ૌઉ': 100, 'ાઊ': 100},
                 'eaa': {'ેઆ': 100, 'િઆ': 40},
                 'eae': {'ેએ': 100},
                 'eai': {'ઇએ': 100},
                 'eao': {'ીઓ': 100, 'ેવ': 100},
                 'eau': {'્યૂ': 100,
                         '્યુ': 25,
                         'ેઆઉ': 0,
                         'ેઅઊ': 0,
                         'ેયૂ': 25,
                         'િયુ': 25,
                         'ાઉ': 0,
                         'ીઉ': 0,
                         'ો': 75},
                 'eea': {'ીએ': 25, 'ીઆ': 100},
                 'eee': {'ી': 100, 'ીએ': 11},
                 'eei': {'િઈ': 100, 'ી': 100, 'ીઈ': 100},
                 'eeu': {'ીઉ': 33, 'ીયુ': 100},
                 'eia': {'ેયા': 66, 'િયા': 100},
                 'eie': {'ેઇએ': 11, 'ી': 100},
                 'eii': {'ેઈ': 66, 'ી': 100},
                 'eiu': {'ેઈયુ': 100},
                 'eoa': {'ેવા': 100, 'ીવા': 100},
                 'eoe': {'ેવે': 100, 'ેઓએ': 25},
                 'eoo': {'ેઊ': 100},
                 'eou': {'ેઓ': 100, 'ેઊ': 100, 'ેવ': 50, 'ેઓઉ': 0},
                 'eua': {'ેયૂઆ': 66, 'ેઉઆ': 100},
                 'eue': {'ેયુએ': 100, 'ેઉે': 60, 'િયુ': 40},
                 'eui': {'ેઉી': 100},
                 'iaa': {'િઆ': 100, 'ીઆ': 100},
                 'iae': {'િએ': 100, 'ીએ': 100},
                 'iai': {'ીએ': 100, 'િએ': 100},
                 'iau': {'િયાઉ': 0,
                         'િઔ': 100,
                         'ીઆઉ': 10,
                         'િઆઉ': 30,
                         'િયાઊ': 0,
                         'ીઅુ': 0,
                         'િઅઉ': 0,
                         'ીઉ': 60},
                 'iea': {'ીએ': 80, 'િએઅ': 0, 'િએ': 0, 'િયા': 100},
                 'iee': {'િએ': 0, 'ી': 100, 'ીઈ': 0, 'ીએ': 11},
                 'iei': {'િએઇ': 5, 'િએ': 100, 'ીઇ': 5},
                 'ieo': {'િવ': 100},
                 'ieu': {'િયૂ': 100},
                 'iia': {'ીઆ': 100, 'ીયા': 0},
                 'iie': {'િઇએ': 100, 'િએ': 100},
                 'iii': {'ીઈઇ': 0, 'ી': 100},
                 'iiu': {'ીઉ': 100, 'ીઊ': 100},
                 'tion': {'શન': 100},
                 'ioa': {'િઓઆ': 0, 'િવા': 100},
                 'ioe': {'ોએ': 100},
                 'ioi': {'ીઓઇ': 100, 'ઓઇ': 100},
                 'ioo': {'િઊ': 100, 'ીઊ': 66},
                 'iou': {'િઓઉ': 0,
                         'ીયુ': 0,
                         'િઉ': 40,
                         'િયૂ': 60,
                         'િય': 0,
                         'ી': 0,
                         'િઓ': 100,
                         'ીય': 0},
                 'iua': {'િઉઆ': 100, 'િઉ': 17, 'ીઉ': 17},
                 'iue': {'િયુએ': 25, 'િઉએ': 100},
                 'iui': {'ીઉઈ': 66, 'િઉઈ': 100},
                 'iuo': {'િઉઓ': 25, 'ુઓ': 100},
                 'iuu': {'િયુ': 28, 'ીયૂ': 100, 'િયૂ': 100, 'િઊ': 57},
                 'oaa': {'ોઆ': 100, 'ૌ': 0},
                 'oae': {'ોએ': 100},
                 'oai': {'ોએ': 100},
                 'oao': {'ોઆઓ': 100},
                 'oau': {'ોઆઉ': 0, 'ઔ': 100, 'ોઔ': 25, 'ોઅયુ': 0},
                 'oea': {'ોએ़': 100, 'ોએઆ': 0, 'ોયઅ': 0, 'ોઇ़': 50, 'ોએ': 16},
                 'oee': {'ોઈ': 100},
                 'oei': {'ોએ': 25, 'ોએઇ': 0, 'ોઈ': 100},
                 'oeo': {'ોએઓ': 100},
                 'oia': {'િયા': 100},
                 'oie': {'ોઇએ': 16, 'ોઈએ': 16, 'ોઇ': 33, 'ોઈ': 100},
                 'oii': {'ોઈ': 100, 'વઈ': 0},
                 'oiu': {'ોઇઉ': 90, 'ોઈઉ': 90, 'ોઈયુ': 21, 'ીયૂ': 100},
                 'ooa': {'ૂઅ': 11, 'ૂઆ': 100, 'ૂ': 0},
                 'ooe': {'ૂએ': 100, 'ૂઈ': 25},
                 'ooi': {'ૂઇ': 25, 'ૂઈ': 100},
                 'ooo': {'ૂઓ': 16, 'ોઊ': 50, 'ૂ': 100},
                 'oou': {'ૂઉ': 11, 'ોઊ': 100},
                 'oua': {'ોવા': 100, 'ૌ': 0, 'ોઊઆ': 0, 'ૌઆ': 100},
                 'oue': {'ૌએ': 100},
                 'oui': {'ૌઇ': 20, 'ૌઈ': 100, 'ુઈ': 60, 'ોઇ': 20},
                 'ouu': {'ોઊ': 100},
                 'uaa': {'ુઆ': 100, 'ુઅ': 11},
                 'uae': {'ુએ': 100, 'ુઅએ': 11},
                 'uai': {'ુઆઇ': 8, 'ુએ': 100, 'ુઆઈ': 8, 'ુઈ': 50},
                 'uao': {'ુઆઓ': 100},
                 'uau': {'ુઆઉ': 0, 'ુઆઊ': 50, 'ુઔ': 100, 'ૂઔ': 100},
                 'uea': {'ુઇ़': 50, 'ુએ': 100, 'ો': 50},
                 'uee': {'િ': 14, 'ુઈ': 100, 'ી': 100, 'ુવી': 71},
                 'uei': {'િવ': 25, 'ુઇ': 100, 'ુએઇ': 0},
                 'ueu': {'ઉ': 100, 'ુ': 49},
                 'uia': {'ુઈ': 100, 'ુઇઆ': 0, 'ુવાઈ': 0, 'ુઇ': 100},
                 'uie': {'ુઇએ': 0, 'ુઈએ': 0, 'ુઈ': 100, 'ુઇ': 42},
                 'uii': {'ુઈ': 100},
                 'uio': {'ુઇઓ': 0, 'િઓ': 100, 'ીઓ': 100},
                 'uiu': {'ુઈઉ': 0, 'ુઇઊ': 42, 'ુયુ': 100},
                 'uoe': {'ુઓએ': 0, 'ો': 66, 'ોએ': 100},
                 'uoi': {'ુઓઇ': 0, 'ોઇ': 66, 'ોઈ': 100},
                 'uoo': {'ુઊ': 25, 'ૂ': 100},
                 'uua': {'ૂ': 5, 'ુઊ': 5, 'ૂઆ': 100},
                 'uue': {'ૂએ': 100, 'ુએ': 25},
                 'uui': {'ૂઈ': 100},
                 'uuu': {'ુ': 0, 'ૂ': 100},
                 'aaaa': {'આઆ': 100},
                 'aaao': {'ાઓ': 100},
                 'aaie': {'એે': 100},
                 'aaiu': {'ૈયૂ': 100},
                 'aiai': {'એએ': 100, 'એ': 100},
                 'aieo': {'ાઇઓ': 100},
                 'aieu': {'ૈયૂ': 100},
                 'auaa': {'ૌઆ': 100},
                 'auai': {'ૌ': 100, 'અૂઅી': 100},
                 'eaiu': {'ૈયુ': 100},
                 'eeai': {'ેએૈ': 100},
                 'iuai': {'િઉાઈ': 100},
                 'iuiu': {'િઉઇઉ': 100},
                 'oooo': {'ોોૂ': 100},
                 'aaaaa': {'ા': 100, 'આઆઅ': 100},
                 'aieai': {'ૈ': 100},
                 'eeaiu': {'ેએૈયુ': 100},
                 'eeeee': {'ી': 100},
                 'oooooo': {'ૂ': 100},
                 'aaaaaaaaa': {'ા': 100},
                 'aaai': {'ાએ': 100},
                 'aaee': {'ાઇ': 100, 'ાએ': 100, 'ાઈ': 100},
                 'aaii': {'ાઈ': 100},
                 'aaoo': {'ાઊ': 100},
                 'aaua': {'ાઉઆ': 100},
                 'aauu': {'ાઊ': 100},
                 'aeiu': {'ૈઇઉ': 100},
                 'aeoo': {'ાએઊ': 100},
                 'aiaa': {'ૈઆ': 100},
                 'aoa': {'ાવા': 100, 'ાઓ': 25, 'ાઓઆ': 0},
                 'aoe': {'વે': 100, 'ાવે': 100, 'ાઓએ': 0},
                 'eeo': {'ીઓ': 100, 'ીયો': 66},
                 'eio': {'ેયો': 100},
                 'eoi': {'ેવી': 100},
                 'euo': {'્વિઓ': 100, 'ઓ': 100, '્યૂઓ': 100, '્યો': 100},
                 'euu': {'ેઊ': 100, 'ીઊ': 25},
                 'iao': {'િઔ': 100},
                 'iio': {'ીઓ': 100, 'ીયો': 66},
                 'oeu': {'ોેઊ': 100},
                 'oio': {'ોયો': 100},
                 'ouo': {'ૌઓ': 100, 'વો': 25},
                 'ueo': {'ુયો': 100},
                 'uoa': {'ુવા': 100, 'ુઓ': 25},
                 'uou': {'ુઓ': 100, 'ૂઓ': 25},
                 'uuo': {'ૂઓ': 100, 'ૂવો': 12, 'ુવો': 12}
                 }}

    dictl = {0: {'a': {'ા': 100, '': 11},
                 'e': {'ે': 100, '': 20},
                 'i': {'ી': 100, 'િ': 100},
                 'o': {'ો': 100},
                 'u': {'ુ': 100, 'ૂ': 35},
                 'aa': {'ા': 100, 'આ': 0},
                 'ae': {'ાએ': 66, 'એ': 100},
                 'ai': {'ાઈ': 33, 'ઈ': 100, 'ાઇ': 0, 'ૈ': 33},
                 'ao': {'ાઓ': 100, 'ઓ': 16, 'ાવ': 50},
                 'au': {'ૌ': 100, 'ાઊ': 66, 'યુ': 0},
                 'ea': {'ેઆ': 100},
                 'ee': {'ી': 100, 'ેએ': 0},
                 'ei': {'ેઈ': 100, 'ેઇ': 28, 'ી': 14},
                 'eo': {'ેવ': 100, 'ેઓ': 25},
                 'eu': {'ેઉ': 33, 'ેયુ': 0, 'ુ': 8, 'ેઊ': 100},
                 'ia': {'િયા': 100, 'િઆ': 40, 'ીયા': 60},
                 'ie': {'ી': 100, 'િએ': 25},
                 'ii': {'ી': 100, 'િઈ': 0, 'ીઈ': 0, 'ઈ': 42},
                 'io': {'િઓ': 100, 'ીઓ': 100, 'િયો': 100, 'ીયો': 100},
                 'iu': {'િઉ': 0,
                        'ીઉ': 0,
                        'િઊ': 25,
                        'િયુ': 50,
                        'િયૂ': 100,
                        'ીયુ': 25,
                        'ીઊ': 25,
                        'ીયૂ': 25},
                 'oa': {'ોઆ': 100, 'ોવા': 100},
                 'oe': {'ોએ': 100, 'ો': 42},
                 'oi': {'ોઈ': 100, 'ોઇ': 19},
                 'oo': {'ૂ': 100},
                 'ou': {'ૂ': 14, 'ૌ': 100, 'ોયુ': 0, 'ોઊ': 14, 'ોઉ': 7, 'ો': 7, 'ૉઉ': 0},
                 'ua': {'ુઆ': 100},
                 'ue': {'ુએ': 100, 'ુઈ': 12, 'ુઇ': 12},
                 'ui': {'ુઈ': 100, 'ુઇ': 13},
                 'uo': {'ુઓ': 11},
                 'uu': {'ુ': 0, 'ૂ': 100},
                 'aaa': {'ા': 21, 'આ': 100, 'ાઆ': 21},
                 'aae': {'ાએ': 100, 'ાઈ': 5, 'ાઇ': 5},
                 'aai': {'ાઇ': 16, 'ાઈ': 100, 'ાએ': 50},
                 'aao': {'ાઓ': 100, 'ાઊ': 5},
                 'aau': {'ાઊ': 100, 'ાઉ': 33, 'ઔ': 66, 'ાઅુ': 0, 'ાઔ': 66, 'આવ': 66},
                 'aea': {'ઈ': 75, 'ાઈ': 75, 'ઇ': 0, 'એય': 100},
                 'aee': {'ઈ': 100, 'ાઈ': 42, 'ઇ': 0, 'ી': 0},
                 'aei': {'ે': 33,
                         'ઈ': 100,
                         'ાઈ': 100,
                         'એ': 16,
                         'ેઇ': 66,
                         'ાઇ': 0,
                         'ઇ': 16,
                         'ૈઇ': 0},
                 'aeo': {'ેઓ': 100},
                 'aeu': {'ાએઉ': 42, 'ેયુ': 100, 'ઈઉ': 42},
                 'aia': {'ય': 0, 'યા': 100, 'ઇઆ': 14, 'ૈ': 0, 'ય્યા': 28},
                 'aie': {'ાઇ': 10, 'ૈએ': 100, 'ાઈએ': 24},
                 'aii': {'ાઈ': 80, 'ૈઇ': 20, 'ઈ': 100},
                 'aio': {'ૈઓ': 100, 'ાઈઓ': 100, 'ાયો': 100},
                 'aiu': {'ૈયુ': 100, 'ૈયૂ': 75, 'ાઈઉ': 7, 'ાઇઉ': 5, 'ઈઉ': 12, 'ૈઉ': 62},
                 'aoi': {'ઓઇ': 100, 'ાઈ': 100, 'ોઈ': 100},
                 'aoo': {'ાઊ': 100, 'ઊ': 66},
                 'aou': {'ાવુ': 25,
                         'ઓઉ': 5,
                         'ાઓઉ': 0,
                         'ૌ': 100,
                         'ાઓ': 5,
                         'ોઊ': 5,
                         'ોઉ': 5,
                         'ાઉ': 5},
                 'aua': {'ૌઆ': 100, 'ૌ': 58, 'ાઉ': 8},
                 'aue': {'ૌએ': 100, 'ાઉે': 11},
                 'aui': {'ૌઈ': 100, 'ૌઇ': 25},
                 'auo': {'ૌઓ': 100, 'ઉઓ': 8, 'ૌઊ': 8, 'ઊઓ': 33},
                 'auu': {'ાઉુ': 0, 'ૌઉ': 100, 'ાઊ': 100},
                 'eaa': {'ેઆ': 100, 'િઆ': 40},
                 'eae': {'ેએ': 100},
                 'eai': {'ઇએ': 100},
                 'eao': {'ીઓ': 100, 'ેવ': 100},
                 'eau': {'્યૂ': 100,
                         '્યુ': 25,
                         'ેઆઉ': 0,
                         'ેઅઊ': 0,
                         'ેયૂ': 25,
                         'િયુ': 25,
                         'ાઉ': 0,
                         'ીઉ': 0,
                         'ો': 75},
                 'eea': {'ીએ': 25, 'ીઆ': 100},
                 'eee': {'ી': 100, 'ીએ': 11},
                 'eei': {'િઈ': 100, 'ી': 100, 'ીઈ': 100},
                 'eeu': {'ીઉ': 33, 'ીયુ': 100},
                 'eia': {'ેયા': 66, 'િયા': 100},
                 'eie': {'ેઇએ': 11, 'ી': 100},
                 'eii': {'ેઈ': 66, 'ી': 100},
                 'eiu': {'ેઈયુ': 100},
                 'eoa': {'ેવા': 100, 'ીવા': 100},
                 'eoe': {'ેવે': 100, 'ેઓએ': 25},
                 'eoo': {'ેઊ': 100},
                 'eou': {'ેઓ': 100, 'ેઊ': 100, 'ેવ': 50, 'ેઓઉ': 0},
                 'eua': {'ેયૂઆ': 66, 'ેઉઆ': 100},
                 'eue': {'ેયુએ': 100, 'ેઉે': 60, 'િયુ': 40},
                 'eui': {'ેઉી': 100},
                 'iaa': {'િઆ': 100, 'ીઆ': 100},
                 'iae': {'િએ': 100, 'ીએ': 100},
                 'iai': {'ીએ': 100, 'િએ': 100},
                 'iau': {'િયાઉ': 0,
                         'િઔ': 100,
                         'ીઆઉ': 10,
                         'િઆઉ': 30,
                         'િયાઊ': 0,
                         'ીઅુ': 0,
                         'િઅઉ': 0,
                         'ીઉ': 60},
                 'iea': {'ીએ': 80, 'િએઅ': 0, 'િએ': 0, 'િયા': 100},
                 'iee': {'િએ': 0, 'ી': 100, 'ીઈ': 0, 'ીએ': 11},
                 'iei': {'િએઇ': 5, 'િએ': 100, 'ીઇ': 5},
                 'ieo': {'િવ': 100},
                 'ieu': {'િયૂ': 100},
                 'iia': {'ીઆ': 100, 'ીયા': 0},
                 'iie': {'િઇએ': 100, 'િએ': 100},
                 'iii': {'ીઈઇ': 0, 'ી': 100},
                 'iiu': {'ીઉ': 100, 'ીઊ': 100},
                 'ioa': {'િઓઆ': 0, 'િવા': 100},
                 'ioe': {'ોએ': 100},
                 'ioi': {'ીઓઇ': 100, 'ઓઇ': 100},
                 'ioo': {'િઊ': 100, 'ીઊ': 66},
                 'iou': {'િઓઉ': 0,
                         'ીયુ': 0,
                         'િઉ': 40,
                         'િયૂ': 60,
                         'િય': 0,
                         'ી': 0,
                         'િઓ': 100,
                         'ીય': 0},
                 'iua': {'િઉઆ': 100, 'િઉ': 17, 'ીઉ': 17},
                 'iue': {'િયુએ': 25, 'િઉએ': 100},
                 'iui': {'ીઉઈ': 66, 'િઉઈ': 100},
                 'iuo': {'િઉઓ': 25, 'ુઓ': 100},
                 'iuu': {'િયુ': 28, 'ીયૂ': 100, 'િયૂ': 100, 'િઊ': 57},
                 'oaa': {'ોઆ': 100, 'ૌ': 0},
                 'oae': {'ોએ': 100},
                 'oai': {'ોએ': 100},
                 'oao': {'ોઆઓ': 100},
                 'oau': {'ોઆઉ': 0, 'ઔ': 100, 'ોઔ': 25, 'ોઅયુ': 0},
                 'oea': {'ોએ़': 100, 'ોએઆ': 0, 'ોયઅ': 0, 'ોઇ़': 50, 'ોએ': 16},
                 'oee': {'ોઈ': 100},
                 'oei': {'ોએ': 25, 'ોએઇ': 0, 'ોઈ': 100},
                 'oeo': {'ોએઓ': 100},
                 'oia': {'િયા': 100},
                 'oie': {'ોઇએ': 16, 'ોઈએ': 16, 'ોઇ': 33, 'ોઈ': 100},
                 'oii': {'ોઈ': 100, 'વઈ': 0},
                 'oiu': {'ોઇઉ': 90, 'ોઈઉ': 90, 'ોઈયુ': 21, 'ીયૂ': 100},
                 'ooa': {'ૂઅ': 11, 'ૂઆ': 100, 'ૂ': 0},
                 'ooe': {'ૂએ': 100, 'ૂઈ': 25},
                 'ooi': {'ૂઇ': 25, 'ૂઈ': 100},
                 'ooo': {'ૂઓ': 16, 'ોઊ': 50, 'ૂ': 100},
                 'oou': {'ૂઉ': 11, 'ોઊ': 100},
                 'oua': {'ોવા': 100, 'ૌ': 0, 'ોઊઆ': 0, 'ૌઆ': 100},
                 'oue': {'ૌએ': 100},
                 'oui': {'ૌઇ': 20, 'ૌઈ': 100, 'ુઈ': 60, 'ોઇ': 20},
                 'ouu': {'ોઊ': 100},
                 'uaa': {'ુઆ': 100, 'ુઅ': 11},
                 'uae': {'ુએ': 100, 'ુઅએ': 11},
                 'uai': {'ુઆઇ': 8, 'ુએ': 100, 'ુઆઈ': 8, 'ુઈ': 50},
                 'uao': {'ુઆઓ': 100},
                 'uau': {'ુઆઉ': 0, 'ુઆઊ': 50, 'ુઔ': 100, 'ૂઔ': 100},
                 'uea': {'ુઇ़': 50, 'ુએ': 100, 'ો': 50},
                 'uee': {'િ': 14, 'ુઈ': 100, 'ી': 100, 'ુવી': 71},
                 'uei': {'િવ': 25, 'ુઇ': 100, 'ુએઇ': 0},
                 'ueu': {'ઉ': 100, 'ુ': 49},
                 'uia': {'ુઈ': 100, 'ુઇઆ': 0, 'ુવાઈ': 0, 'ુઇ': 100},
                 'uie': {'ુઇએ': 0, 'ુઈએ': 0, 'ુઈ': 100, 'ુઇ': 42},
                 'uii': {'ુઈ': 100},
                 'uio': {'ુઇઓ': 0, 'િઓ': 100, 'ીઓ': 100},
                 'uiu': {'ુઈઉ': 0, 'ુઇઊ': 42, 'ુયુ': 100},
                 'uoe': {'ુઓએ': 0, 'ો': 66, 'ોએ': 100},
                 'uoi': {'ુઓઇ': 0, 'ોઇ': 66, 'ોઈ': 100},
                 'uoo': {'ુઊ': 25, 'ૂ': 100},
                 'uua': {'ૂ': 5, 'ુઊ': 5, 'ૂઆ': 100},
                 'uue': {'ૂએ': 100, 'ુએ': 25},
                 'uui': {'ૂઈ': 100},
                 'uuu': {'ુ': 0, 'ૂ': 100},
                 'aoa': {'ાવા': 100, 'ાઓ': 25, 'ાઓઆ': 0},
                 'aoe': {'વે': 100, 'ાવે': 100, 'ાઓએ': 0},
                 'eeo': {'ીઓ': 100, 'ીયો': 66},
                 'eio': {'ેયો': 100},
                 'eoi': {'ેવી': 100},
                 'euo': {'્વિઓ': 100, 'ઓ': 100, '્યૂઓ': 100, '્યો': 100},
                 'euu': {'ેઊ': 100, 'ીઊ': 25},
                 'iao': {'િઔ': 100},
                 'iio': {'ીઓ': 100, 'ીયો': 66},
                 'oeu': {'ોેઊ': 100},
                 'oio': {'ોયો': 100},
                 'ouo': {'ૌઓ': 100, 'વો': 25},
                 'ueo': {'ુયો': 100},
                 'uoa': {'ુવા': 100, 'ુઓ': 25},
                 'tion': {'શન': 100},
                 'uou': {'ુઓ': 100, 'ૂઓ': 25},
                 'uuo': {'ૂઓ': 100, 'ૂવો': 12, 'ુવો': 12},
                 'aaao': {'ાઓ': 100},
                 'aaie': {'એે': 100},
                 'aaiu': {'ૈયૂ': 100},
                 'aiai': {'એએ': 100, 'એ': 100},
                 'aieo': {'ાઇઓ': 100},
                 'aieu': {'ૈયૂ': 100},
                 'auaa': {'ૌઆ': 100},
                 'auai': {'ૌ': 100, 'અૂઅી': 100},
                 'eaiu': {'ૈયુ': 100},
                 'eeai': {'ેએૈ': 100},
                 'iuai': {'િઉાઈ': 100},
                 'iuiu': {'િઉઇઉ': 100},
                 'oooo': {'ોોૂ': 100},
                 'aaaaa': {'ા': 100, 'આઆઅ': 100},
                 'aieai': {'ૈ': 100},
                 'eeaiu': {'ેએૈયુ': 100},
                 'eeeee': {'ી': 100},
                 'oooooo': {'ૂ': 100},
                 'aaaaaaaaa': {'ા': 100},
                 'aaai': {'ાએ': 100},
                 'aaee': {'ાઇ': 100, 'ાએ': 100, 'ાઈ': 100},
                 'aaii': {'ાઈ': 100},
                 'aaoo': {'ાઊ': 100},
                 'aaua': {'ાઉઆ': 100},
                 'aauu': {'ાઊ': 100},
                 'aeiu': {'ૈઇઉ': 100},
                 'aeoo': {'ાએઊ': 100},
                 'aiaa': {'ૈઆ': 100}
                 }, 1: {'b': {'બ': 100},
                        'c': {'ક': 100},
                        'd': {'ડ઼': 4, 'દ': 100, 'ડ': 11, 'ડ્': 0},
                        'f': {'ફ઼': 9, 'ફ': 100},
                        'g': {'ગ': 100},
                        'h': {'હ': 100},
                        'j': {'જ': 100},
                        'k': {'ક': 100, 'ક઼': 0},
                        'l': {'લ': 100},
                        'm': {'મ': 100, 'ં': 0},
                        'n': {'ન': 100, 'ં': 14, 'ઁ': 0, 'ણ': 28},
                        'p': {'પ': 100},
                        'q': {'ક': 29, 'ક઼': 100},
                        'r': {'ર': 100},
                        's': {'સ': 100},
                        't': {'ત': 100, 'ટ': 14},
                        'v': {'વ': 100},
                        'w': {'વ': 100},
                        'x': {'ક્સ': 100},
                        'y': {'ય': 100},
                        'z': {'જ઼': 100, 'જ': 100},
                        'bh': {'ભ': 100},
                        'ch': {'ચ': 100, 'છ': 1},
                        'dh': {'ધ': 100, 'ડ઼': 9, 'ઢ઼': 55, 'ઢ': 20},
                        'gh': {'ઘ': 100},
                        'jh': {'ઝ': 100},
                        'kh': {'ખ': 100, 'ખ઼': 0},
                        'ny': {'ન્ય': 100},
                        'ph': {'ફ': 100, 'ફ઼': 17},
                        'rh': {'ઢ઼': 100, 'ડ઼': 33},
                        'sh': {'શ': 100, 'ષ': 17},
                        'th': {'થ': 100, 'ઠ': 6},
                        'ye': {'યે': 100, 'એ': 42},
                        'yi': {'ઈ': 16, 'યી': 100},
                        'chh': {'છ': 100},
                        'tch': {'ચ્': 100, 'ચ': 0},
                        'tion': {'શન': 100}
                        }}

    exact_guj = {'a': 'એ',
                 'b': 'બી',
                 'c': 'સી',
                 'd': 'ડી',
                 'e': 'ઈ',
                 'f': 'એફ',
                 'g': 'જી',
                 'h': 'એચ',
                 'i': 'આઈ',
                 'j': 'જે',
                 'k': 'કે',
                 'l': 'એલ',
                 'm': 'એમ',
                 'n': 'એન',
                 'o': 'ઓ',
                 'p': 'પી',
                 'q': 'ક્યૂ',
                 'r': 'આર',
                 's': 'એસ',
                 't': 'ટી',
                 'u': 'યૂ',
                 'v': 'વી',
                 'w': 'ડબ્લ્યૂ',
                 'x': 'એક્સ',
                 'y': 'વ્હાઈ',
                 'z': 'જ઼ેડ',
                 'Dr.': 'ડા',
                 'tax': 'ટૈક્સ',
                 'office': 'ઓફિસ',
                 'smt': 'શ્રીમતી'
                 }

    def wrd_break(self, w):
        # Function for breaking an english word about vyanjan
        w = w.lower()
        w1 = []
        xt = ()
        for i in self.dict_en3:
            xt += tuple((m.start(), len(i)) for m in re.finditer(i, w))
        for i in self.dict_en2:
            xt += tuple((m.start(), len(i)) for m in re.finditer(i, w))
        for i in self.dict_en1:
            xt += tuple((m.start(), len(i)) for m in re.finditer(i, w))

        yt = tuple((i, i + j) for i, j in xt)
        yt = sorted(list(yt), key=lambda x: x[0])

        if len(yt) > 0:
            fin = [yt[0]]  # consonent

            for i in yt[1:]:
                if i[0] >= fin[-1][1]:
                    fin.append(i)

            bin = [1] * len(fin)  # no df consonents in that string
            fin1 = fin.copy()
            if fin[0][0] != 0:
                fin1.insert(0, (0, fin[0][0]))
                bin.insert(0, 0)

            prev = fin[0]
            for i in fin[1:]:
                if i[0] > prev[1]:
                    ind = fin1.index(i)
                    fin1.insert(ind, (prev[1], i[0]))
                    bin.insert(ind, 0)

                prev = i
            if fin[-1][1] < len(w):
                fin1.append((fin[-1][1], len(w)))
                bin.append(0)
            fin2 = []
            cnt = -1
            for i in fin1:
                cnt = cnt + 1

                if (i[1] - i[0] > 3 and w[i[0]:i[1]] != 'tion'):  # not in dictm or dictf or dictl or half
                    p = i[0]
                    curr_len = i[1] - i[0]
                    while (p < i[1]):
                        fin2.append((p, min(p + 2, i[1])))
                        if (p != i[0]):
                            bin.insert(len(fin2) - 1, 0)
                        p = p + 2

                else:
                    fin2.append(i);

            for i in bin:
                # print(i)
                fin1 = []
                fin1 = fin2
            for i in fin1:
                w1.append(w[i[0]:i[1]])

            return w1, bin
        return [w, [0]]

    def eng_guj_translate(self,w):
        # Function for translating the split characters from english to hindi
        #     detector = Translator()
        #     dec_lan = detector.detect(w)
        #     #print(dec_lan.lang)

        if (False):
            return w
        else:
            w, b = self.wrd_break(w)  # List of characters split about vyanjan
            temw = []
            finw = []
            temw1 = []
            # finw.append(dictf[b[0]][w[0]])
            for i in range(len(b) - 1):
                if b[i + 1] == 1 and b[i] == 1:
                    finw.append(self.half[w[i]])
                elif i == 0:
                    finw.append(self.dictf[b[i]][w[i]])
                else:
                    finw.append(self.dictm[b[i]][w[i]])

            finw.append(self.dictl[b[-1]][w[-1]])

            from queue import PriorityQueue
            q = PriorityQueue()
            # print(finw)
            for i in finw[0]:
                q.put((-1 * finw[0][i], i))

            for i in range(1, len(finw)):
                qtemp = PriorityQueue()
                while not q.empty():
                    temp = q.get()
                    for j in finw[i]:
                        qtemp.put((temp[0] + (-1 * finw[i][j]), temp[1] + j))

                q1 = PriorityQueue()
                q = q1
                c = 15
                while (not qtemp.empty() and c):
                    temp2 = qtemp.get()
                    q.put((temp2[0], temp2[1]))
                    c -= 1

            lisq = []
            while not q.empty():
                t = q.get()[1]
                lisq.append(t)

            return lisq

    def Eng_gujarati_Transliteration(self,d, a):

        lis = sorted(d.items(), key=lambda kv: kv[1], reverse=True)
        sorted_lis = []
        for i in lis:
            sorted_lis.append(i[0])

        # sorted_lis.append(a)

        for i in self.eng_guj_translate(a):
            if (i not in d):
                sorted_lis.append(i)

        return sorted_lis

    def Database_Search_English(self,a):
        a = a.capitalize()

        try:
            """
            Try to find the word in the database, if it does not exists directly call algorithm function
            """
            possible_match = EnglishToGujaratiTranslation.objects.filter(
                english__iexact=a
            ).first()
            if possible_match is not None:
                possible_match_dict = possible_match.gujarati

                if isinstance(next(iter(possible_match_dict.items()))[1], int):
                    possible_match_dict = sorted(
                        possible_match_dict.items(),
                        key=lambda item: item[1],
                        reverse=True,
                    )
                    highest_match = next(iter(possible_match_dict))  # making this tuple
                    temp_dict = dict()
                    temp_dict[highest_match[0]] = highest_match[1]
                    sorted_list = self.Eng_gujarati_Transliteration(temp_dict, a)
                    return sorted_list
                else:
                    sorted_keys = sorted(
                        possible_match_dict,
                        key=lambda x: (
                            possible_match_dict[x]["manual"],
                            possible_match_dict[x]["score"],
                            possible_match_dict[x]["time"],
                        ),
                        reverse=True,
                    )
                    temp_dict = dict()
                    highest_match = sorted_keys[0]
                    temp_dict[highest_match] = possible_match_dict[highest_match]
                    sorted_list = self.Eng_gujarati_Transliteration(temp_dict, a)
                    return sorted_list
            else:
                return self.eng_guj_translate(a)
        except Exception as e:
            # To work
            print(e)

    def tran(self, w_list, wrd):
        for i in w_list:
            try:
                wrd = wrd.replace(i, self.eng_to_hin[i])
            except:
                wrd = wrd.replace(i, "")
                continue
        return wrd

    def convert(self, words: str):
        applied_filter_list = self.split_sort(words)
        for word in applied_filter_list:
            translated_word = self.Database_Search_English(word)
            if translated_word:
                translated_word = translated_word[0]

            if word not in self.eng_to_hin:
                self.eng_to_hin[word] = translated_word
            words = words.replace(word, translated_word)
        return words

    def split_sort(self, sentence):
        return sorted(
            list(
                set(
                    filter(
                        None,
                        re.sub("\s+", " ", re.sub("[^a-zA-Z]", " ", str(sentence)))
                        .strip()
                        .split(" "),
                    )
                )
            ),
            key=len,
            reverse=True,
        )

    def excel_english_to_hindi(self, f):
        file = f
        df1 = pd.read_excel(file)
        lis_unique = []
        # files = glob.glob(r'C:\Users\Dell\Downloads\Ravi\*')
        # for file in files:

        st = time.time()
        # columns = ["Name", "Father's/Husband's Name"]
        # columns = ['Name Cleaned']
        for column in df1.columns:
            # for column in columns:
            print(column)
            unique = list(df1[column].drop_duplicates())
            lis_unique = lis_unique + unique

        print(time.time() - st)

        lis_split = []
        for i in range(0, len(lis_unique)):
            lis_split.append(re.split(r"[^a-zA-Z]", str(lis_unique[i])))
        print(time.time() - st)

        flatlist = []
        for elem in lis_split:
            flatlist.extend(elem)
        lis_dis = set(flatlist)
        lis_dis = list(lis_dis)
        print(time.time() - st)

        for i in range(0, len(lis_dis)):
            lis_dis[i] = lis_dis[i].lower()

        print(time.time() - st)
        lis_dis_lower = set(lis_dis)
        print(time.time() - st)
        print(len(lis_dis_lower))

        lis1 = []
        d_new = {}
        count = 0

        for key in lis_dis_lower:

            count = count + 1
            print(count)
            try:

                d_new[key] = self.Database_Search_English(key)[0]

            except:
                lis = key
                if lis not in lis1:
                    lis1.append(lis)
                continue

        global settemp
        settemp = set()

        def tran(w_list, wrd):

            for i in w_list:
                try:
                    wrd = wrd.replace(i, d_new[i.lower()])
                except:
                    # settemp.add((i))
                    wrd = wrd.replace(i, "")
                    continue
            return wrd

        # df1 = pd.read_excel(r'D:\Data\Translation_Files\Uttarakhand Data\7594-Uttarakhand-Karyakarta-CountryState--Shakti_Kendra-Core_Sangathan-Karyakarni-.xlsx')
        # columns = ['Name Cleaned']
        for column in df1.columns:
            print(column)
            if column == "BM_split":
                continue
            # df1[column] = df1[column].apply(lambda x: re.sub("\s+", " ",re.sub("[^A-Za-z]", " ", x)).strip().title() if x==x else np.nan)
            df1["BM_split"] = df1[column].apply(
                lambda x: sorted(
                    list(
                        set(
                            filter(
                                None,
                                re.sub("\s+", " ", re.sub("[^a-zA-Z]", " ", str(x)))
                                .strip()
                                .split(" "),
                            )
                        )
                    ),
                    key=len,
                    reverse=True,
                )
                if x == x
                else []
            )

            df1[column + "_Gujarati"] = df1[["BM_split", column]].apply(
                lambda x: tran(*x), axis=1
            )
            del df1["BM_split"]
        # df1.to_excel(r'D:\Data\Translation_Files\suyash_translate_areaidentifier_Hindi.xlsx', index= False)
        print(df1)
        # df1.to_excel('/home/this/Downloads/pokemon_check.xlsx', index=False)
        return df1
